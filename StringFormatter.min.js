!function(t){function e(t,e,n,s){var r,i,u,a=s||"",o=a.indexOf("g")>-1,p=new RegExp(e+"|"+n,(o?"":"g")+a),c=new RegExp(e,a.replace(/g/g,"")),h=[];do for(r=0;u=p.exec(t);)if(c.test(u[0]))r++||(i=p.lastIndex);else if(r&&!--r&&(h.push(t.slice(i,u.index)),!o))return h;while(r&&(p.lastIndex=i));return h}function n(t,e,n,s,r,i){var u,a,o,p,c=s||"",h=c.indexOf("g")>-1,f=new RegExp(e+"|"+n,(h?"":"g")+c),d=new RegExp(e,c.replace(/g/g,"")),l=t.slice(),g=i?"":e.replace("\\",""),b=i?"":n.replace("\\","");do for(u=0;o=f.exec(t);)if(d.test(o[0]))u++||(a=f.lastIndex);else if(u&&!--u&&(p=t.slice(a,o.index),l=l.replace(g+p+b,r),!h))return l;while(u&&(f.lastIndex=a));return l}function s(t){var e=t+"",n=e.indexOf("function ");if(-1===n)return null;var s=n+"function ".length,r=e.indexOf("(",s);return-1===r?null:e.substring(s,r)}function r(t,e){this.spec=t,this.func=e}function i(t,e){this.spec=t,this.date=new Date(e)}function u(){this.cache={},this.gcOn=!0,this.hits=0,this.gcThreshold=1e3,this.gcPurgeLessThan=1,this.formats={string:function(t,e){var n=e+"",s="";if(t.width){var r=t.width-n.length;r>0&&(s=(t.padding?t.padding:"").repeat(r))}return n=s+n},number:function(t,e){var n=parseFloat(e);if(n+""=="NaN")return null!=t.ifNaN?t.ifNaN:n;if(1/0===n||n===-1/0)return null!=t.ifInfinity?t.ifInfinity:n;if(null!=t.precision&&(n=n.toPrecision(t.precision)),null!=t.fixed&&(n=parseFloat(n).toFixed(t.fixed)),t.as){var s=t.as[0];switch(s){case"%":n+="%";break;case"h":n=(n>=0?"0x":"-0x")+n.toString(16).replace("-","");break;case"o":n=(n>=0?"0":"-0")+n.toString(8).replace("-","");break;case"b":n=n.toString(2);break;case"e":n=n.toExponential()}}var r="";if(t.width){var i=n+"",u=i.length-(t.sign?t.sign.length:0);u>0&&(r=(t.padding?t.padding:"0").repeat(u))}return n=t.sign&&parseInt(n)<0?(t.sign instanceof Array?t.sign[0]:t.sign)+r+n+(t.sign instanceof Array?t.sign[1]:t.sign):r+n,n=t.currency?t.currency+n:n,n=t.accounting&&0>e?"("+(n+"").replace("-","")+")":n},"boolean":function(t,e){var n=e;switch(t.as){case"string":n=e?"yes":"no";break;case"number":n=e?1:0;break;default:n=e?!0:!1}var s="";if(t.width){var r=t.padding-n.length;r>0&&(s=(t.padding?t.padding:"").repeat(r))}return n=s+n}},this.formats.object=this.formats.Object,this.formats["function"]=this.formats.Function}function a(t,e){function n(e){return t.include?t.include.indexOf(e)>=0:t.exclude?-1===t.exclude.indexOf(e):!0}var s,r={};for(var i in t)"width"!==i&&"padding"!==i&&(r[i]=t[i]);if(this instanceof Object){var u=this,a=Object.keys(this),o={};a.forEach(function(s){n(s)&&(u[s]instanceof Object?o[s]=e.formats[u[s].constructor.name]?e.formats[u[s].constructor.name].call(u[s],r,e):e.formats.Object.call(u[s],r,e):(!t.matchValue||t.matchValue.test&&t.matchValue.test(u[s]+""))&&(o[s]=e.formats[typeof u[s]](r,u[s])))}),s=JSON.stringify(o)}var p="";if(t.width){var c=t.padding-s.length;c>0&&(p=(t.padding?t.padding:"").repeat(c))}return s=p+s}function o(t,e){function n(e){return t.include?t.include.some(function(t){return e===t||t instanceof Array&&e>=t[0]&&e<=t[1]?!0:!1})?!0:!1:t.exclude&&t.exclude.some(function(t){return e===t||t instanceof Array&&e>=t[0]&&e<=t[1]?!0:!1})?!1:!0}var s,r=t.delimiter?t.delimiter:",",i=t.container?t.container:["",""],u={};for(var a in t)"width"!==a&&"padding"!==a&&(u[a]=t[a]);if(this instanceof Array){for(var o=[],p=0;p<this.length;p++)if(n(p)){var c=this[p];c instanceof Object?o.push(e.formats[c.constructor.name]?(t.quote?"'":"")+e.formats[c.constructor.name].call(c,u,e)+(t.quote?"'":""):(t.quote?"'":"")+e.formats.Object.call(c,u,e)+(t.quote?"'":"")):(!t.matchValue||t.matchValue.test&&t.matchValue.test(c+""))&&o.push((t.quote?"'":"")+e.formats[typeof c](u,c)+(t.quote?"'":""))}s=i[0]+o.join(r)+i[1]}var h="";if(t.width){var f=t.padding-s.length;f>0&&(h=(t.padding?t.padding:"").repeat(f))}return s=h+s}function p(t){var e=new i(t.format,this);return e.format()}function c(t){var e=new r(t.format,this);return e.format()}r.prototype.format=function(){if(!this.spec)return this.func+"";var t=[];t.push(this.getValue()),t.push(this.getHead()),t.push(this.getArguments()),t.push(this.getBody()),t.push(this.getLength()),t.push(this.getNameAnonymous()),t.push(this.getName());var e=""+this.spec;return t.forEach(function(t){t&&(e=e.replace(t.pattern,t.substitute))}),e},r.prototype.getValue=function(){return this.spec.indexOf("v")>=0?{substitute:this.func(),pattern:"v"}:null},r.prototype.getHead=function(){if(this.spec.indexOf("h")>=0){var t=this.func+"",e=t.indexOf(" {");return{substitute:t.substring(0,e),pattern:"h"}}return null},r.prototype.getArguments=function(){if(this.spec.indexOf("a")>=0){var t,e=this.func+"",n=e.indexOf("("),s=e.indexOf(")");return n>=0&&s>=0&&s>n&&(t=e.substring(n+1,s)),{substitute:t.split(",").join(", "),pattern:"a"}}return null},r.prototype.getBody=function(){if(this.spec.indexOf("b")>=0){var t=this.func+"",e=t.indexOf("{"),n=t.lastIndexOf("}");return{substitute:t.substring(e+2,n-1),pattern:"b"}}return null},r.prototype.getLength=function(){return this.spec.indexOf("l")>=0?{substitute:this.func.length,pattern:"l"}:null},r.prototype.getNameAnonymous=function(){if(this.spec.indexOf("N")>=0){var t=s(this.func);return{substitute:null==t||0===t.length?"anonymous":t,pattern:"N"}}return null},r.prototype.getName=function(){if(this.spec.indexOf("n")>=0&&-1===this.spec.indexOf("na")){var t=s(this.func);return{substitute:null==t||""===t?"":t,pattern:"n"}}return null},i.prototype.format=function(){if(!this.spec)return this.date.toString();var t=[];t.push(this.getMonth()),t.push(this.getQuarter()),t.push(this.getYear()),t.push(this.getDayOfYear()),t.push(this.getDayOfMonth()),t.push(this.getDayOfWeek()),t.push(this.getAMPM()),t.push(this.getHours()),t.push(this.getMinutes()),t.push(this.getSeconds()),t.push(this.getMilliseconds()),t.push(this.getTime()),t.push(this.getTimezoneOffset()),t.push(this.toUTCString()),t.push(this.toGMTString()),t.push(this.toISOString()),t.push(this.toLocaleString()),t.push(this.toTimeString());var e=""+this.spec;return t.forEach(function(t){t&&(e=e.replace(t.pattern,t.substitute))}),e},i.prototype.getMonth=function(){var t=this.date.getMonth(),e=["January","February","March","April","May","June","July","August","September","October","November","December"];if(this.spec.indexOf("MMMM")>=0)return{substitute:e[t],pattern:"MMMM"};if(this.spec.indexOf("MMM")>=0)return{substitute:e[t].substring(0,3),pattern:"MMM"};if(this.spec.indexOf("MM")>=0)return{substitute:9>t?"0"+(t+1):""+(t+1),pattern:"MM"};if(this.spec.indexOf("Mo")>=0)switch(t){case 0:return{substitute:"1st",pattern:"Mo"};case 1:return{substitute:"2nd",pattern:"Mo"};case 2:return{substitute:"3rd",pattern:"Mo"};default:return{substitute:t+1+"th",pattern:"Mo"}}return this.spec.indexOf("M")>=0?{substitute:""+(1+t),pattern:"M"}:null},i.prototype.getQuarter=function(){var t=this.date.getMonth();return this.spec.indexOf("Q")>=0?3>t?{substitute:"1",pattern:"Q"}:6>t?{substitute:"2",pattern:"Q"}:9>t?{substitute:"3",pattern:"Q"}:{substitute:"4",pattern:"Q"}:null},i.prototype.getYear=function(){var t=this.date.getFullYear()+"";return this.spec.indexOf("YYYY")>=0?{substitute:t,pattern:"YYYY"}:this.spec.indexOf("YY")>=0?{substitute:t.substring(2),pattern:"YY"}:null},i.prototype.getDayOfYear=function(){var t=new Date(this.date);t.setHours(23);var e=Math.round((t-new Date(t.getFullYear(),0,1,0,0,0))/1e3/60/60/24);return this.spec.indexOf("DDDD")>=0?{substitute:10>e?"00"+e:100>e?"0"+e:""+e,pattern:"DDDD"}:this.spec.indexOf("DDDo")>=0?(e+="",e=e.lastIndexOf("1")==e.length+1?e+"st":e.lastIndexOf("2")===e.length+1?e+"nd":e.lastIndexOf("3")===e.length+1?e+"rd":e+"th",{substitute:e,pattern:"DDDo"}):this.spec.indexOf("DDD")>=0?{substitute:""+e,pattern:"DDD"}:null},i.prototype.getDayOfMonth=function(){var t=this.date.getDate();if(this.spec.indexOf("DD")>=0)return 10>t?{substitute:"0"+t,pattern:"DD"}:{substitute:""+t,pattern:"DD"};if(this.spec.indexOf("Do")>=0)switch(t){case 1:return{substitute:"1st",pattern:"Do"};case 2:return{substitute:"2nd",pattern:"Do"};case 3:return{substitute:"3rd",pattern:"Do"};case 21:return{substitute:"21st",pattern:"Do"};case 22:return{substitute:"22nd",pattern:"Do"};case 23:return{substitute:"23rd",pattern:"Do"};case 31:return{substitute:"31st",pattern:"Do"};default:return{substitute:t+"th",pattern:"Do"}}return this.spec.indexOf("D")>=0?{substitute:""+t,pattern:"D"}:null},i.prototype.getDayOfWeek=function(){var t=this.date.getDay(),e=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];if(this.spec.indexOf("dddd")>=0)return{substitute:e[t],pattern:"dddd"};if(this.spec.indexOf("ddd")>=0)return{substitute:e[t].substring(0,3),pattern:"ddd"};if(this.spec.indexOf("dd")>=0)return{substitute:e[t].substring(0,2),pattern:"dd"};if(this.spec.indexOf("do")>=0)switch(t){case 0:return{substitute:"1st",pattern:"do"};case 1:return{substitute:"2nd",pattern:"do"};case 2:return{substitute:"3rd",pattern:"do"};default:return{substitute:t+1+"th",pattern:"do"}}return this.spec.indexOf("d")>=0?{substitute:""+t,pattern:"d"}:null},i.prototype.getHours=function(){var t=this.date.getHours();return this.spec.indexOf("HH")>=0?{substitute:10>t?"0"+t:""+t,pattern:"HH"}:this.spec.indexOf("H")>=0?{substitute:""+t,pattern:"H"}:(t=0==t?12:t,t=t>12?t-12:t,this.spec.indexOf("hh")>=0?{substitute:10>t?"0"+t:""+t,pattern:"hh"}:this.spec.indexOf("h")>=0?{substitute:""+t,pattern:"h"}:null)},i.prototype.getAMPM=function(){var t=this.date.getHours();return this.spec.indexOf("A")>=0?{substitute:t>11?"PM":"AM",pattern:"A"}:this.spec.indexOf("a")>=0?{substitute:t>11?"pm":"am",pattern:"a"}:null},i.prototype.getMinutes=function(){var t=this.date.getMinutes();return this.spec.indexOf("mm")>=0?{substitute:10>t?"0"+t:t+"",pattern:"mm"}:this.spec.indexOf("m")>=0?{substitute:t+"",pattern:"m"}:null},i.prototype.getSeconds=function(){var t=this.date.getSeconds();return this.spec.indexOf("ss")>=0?{substitute:10>t?"0"+t:t+"",pattern:"ss"}:this.spec.indexOf("s")>=0?{substitute:t+"",pattern:"s"}:null},i.prototype.getMilliseconds=function(){var t=this.date.getMilliseconds()+"";return this.spec.indexOf("SSS")>=0?{substitute:t,pattern:"SSS"}:this.spec.indexOf("SS")>=0?{substitute:t.substring(0,2),pattern:"SS"}:this.spec.indexOf("S")>=0?{substitute:t.substring(0,1),pattern:"S"}:null},i.prototype.getTime=function(){var t=this.date.getTime()+"";return this.spec.indexOf("X")>=0?{substitute:t,pattern:"X"}:null},i.prototype.getTimezoneOffset=function(){var t=this.date.getTimezoneOffset(),e=0>t?!0:!1,n=Math.abs(t/60),s=parseInt(n)+"";s=10>s?"0"+s:s+"",s=e?"-"+s:"+"+s;var r=Math.abs(t%60);return r=10>r?"0"+r:r+"",this.spec.indexOf("ZZ")>=0?{substitute:s+":"+r,pattern:"ZZ"}:this.spec.indexOf("Z")>=0?{substitute:s+r,pattern:"Z"}:null},i.prototype.toUTCString=function(){return this.spec.indexOf("U")>=0?{substitute:this.date.toUTCString().replace("GMT","UTC"),pattern:"U"}:null},i.prototype.toGMTString=function(){return this.spec.indexOf("G")>=0?{substitute:this.date.toUTCString().replace("UTC","GMT"),pattern:"G"}:null},i.prototype.toISOString=function(){return this.spec.indexOf("I")>=0?{substitute:this.date.toISOString(),pattern:"I"}:null},i.prototype.toLocaleString=function(){return this.spec.indexOf("L")>=0?{substitute:this.date.toLocaleString(),pattern:"L"}:null},i.prototype.toTimeString=function(){return this.spec.indexOf("T")>=0?{substitute:this.date.toTimeString(),pattern:"T"}:this.spec.indexOf("t")>=0?{substitute:this.date.toLocaleTimeString(),pattern:"t"}:null},u.prototype.gc=function(){for(var t in this.cache)this.cache[t].hits<=this.gcPurgeLessThan&&delete this.cache[t]},u.prototype.register=function(t,e,n){n||(n=t.name),this.formats[n]=e?e:t.prototype.StringFormatter},u.prototype.polyfill=function(){var t=this;String.prototype.format=function(){var e=Array.prototype.slice.call(arguments,0);e.unshift(this);var n=t.format.apply(t,e);return n.substring(1,n.length-2)}},u.prototype.format=function(t){var s=this,r=Array.prototype.slice.call(arguments,1),i=t instanceof Object?JSON.stringify(t):t;s.hits++,s.gcOn&&s.hits>=s.gcThreshold&&s.gc();var u=this.cache[i];if(!u){u={patterns:[],statics:[],hits:0},-1===i.indexOf("@value")&&-1===i.indexOf("@arguments")&&(this.cache[i]=u);var a=n(i,"\\{","\\}","g","@!$format$!@");u.statics=a.split("@!$format$!@"),u.patterns=e(i,"\\{","\\}","g"),u.patterns&&u.patterns.forEach(function(t,e){t.indexOf(":")>=0?(t=t.replace(/@value/g,"$value"),t=t.replace(/@argumentse/g,"$arguments"),u.patterns[e]=Function("$value","$arguments","return {"+t+"}")(r[e],r)):(u.patterns[e]={},u.patterns[e][t]={})})}u.hits++;var o=[],r=arguments;return u.statics.forEach(function(t,e){if(o.push(t),e<r.length-1&&e<u.patterns.length){var n=r[e+1],i=u.patterns[e],a=Object.keys(i)[0],p=i[a],c="function"==typeof s.formats[a]?n instanceof Object?s.formats[a].call(n,p,s):s.formats[a](p,n):i;p.style&&(c="<span style='"+p.style+"'>"+c+"</span>"),o.push(c)}}),o.join("")},t.StringFormatter=new u,t.StringFormatter.register(Array,o,"Array"),t.StringFormatter.register(Object,a,"Object"),t.StringFormatter.register(Object,a,"object"),t.StringFormatter.register(Date,p,"Date"),t.StringFormatter.register(Function,c,"Function"),t.StringFormatter.register(Function,c,"function")}("undefined"!=typeof exports&&"undefined"!=typeof global?global:window);